.. Copyright (C) 2019 Wazuh, Inc.

.. _reference_ossec_logging:

logging
=======

.. topic:: XML section name

    .. code-block:: xml

      <logging>
      </logging>

This section shows how to configure the output of the three types of Wazuh logs (archives, alerts and ossec).

Logs compatibility
------------------

The following table shows where these log are available, in plain text and JSON format.

+-------------+----------------------+
| Log file    | Install type         |
+=============+======================+
| ossec       | manager / agent      |
+-------------+----------------------+
| alerts      | manager              |
+-------------+----------------------+
| archives    | manager              |
+-------------+----------------------+

Options
-------

- `log_format`_
- `log`_
- `alerts`_
- `archives`_

log_format
^^^^^^^^^^

.. note:: This option is deprecated since Wazuh 3.9.0. Use ``logs`` instead.

Specifies the log format between JSON output (.json) or plain text (.log). It also can be set to output both formats at the same time, when both are formats are entered, separated by a comma.

Depending on the given format, the output file will be ``/var/ossec/logs/ossec.log``, ``/var/ossec/logs/ossec.json`` or both of them.

+--------------------+----------------+
| **Default value**  | plain          |
+--------------------+----------------+
| **Allowed values** | - plain        |
|                    | - json         |
|                    | - plain, json  |
+--------------------+----------------+

log
^^^

Configures the output of standard Wazuh logs (``ossec.log`` and ``ossec.json`` files).

Options:

+--------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|   enabled          | Enable or disable this log output.                                                                                                                                                                                                                                                             |
|                    +--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    | **Allowed values** | yes, no                                                                                                                                                                                                                                                                   |
|                    +--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    | **Default value**  | no                                                                                                                                                                                                                                                                        |
+--------------------+--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|   format           | Sets the output format.                                                                                                                                                                                                                                                                        |
|                    +--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    | **Allowed values** | - plain (to write in ``ossec.log``)                                                                                                                                                                                                                                       |
|                    |                    | - json (to write in ``ossec.json``)                                                                                                                                                                                                                                       |
|                    |                    | - json,plain (to write in both files)                                                                                                                                                                                                                                     |
|                    +--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    | **Default value**  | plain                                                                                                                                                                                                                                                                     |
+--------------------+--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|   rotation         | Configure the log rotation.                                                                                                                                                                                                                                                                    |
|                    +---------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    | **Allowed options** |                       | Enable or disable log rotation.                                                                                                                                                                                                                  |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |   enabled             | **Allowed values** | yes, no                                                                                                                                                                                                                     |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | **Default value**  | yes                                                                                                                                                                                                                         |
|                    |                     +-----------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | Configure the rotation interval.                                                                                                                                                                                                                 |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |   interval            | **Allowed values** | A positive number that should contain a suffix character indicating a time unit: s (seconds), m (minutes) or h (hours).                                                                                                     |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | **Default value**  | 0 (rotation by interval disabled)                                                                                                                                                                                           |
|                    |                     +-----------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | Configure the log compression.                                                                                                                                                                                                                   |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |   compress            | **Allowed values** | yes, no                                                                                                                                                                                                                     |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | **Default value**  | yes                                                                                                                                                                                                                         |
|                    |                     +-----------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | Configure the rotation by size.                                                                                                                                                                                                                  |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |   max_size            | **Allowed values** | A positive number that should contain a suffix character indicating a time unit: B (byte), K (kilobyte), M (megabyte) or G (gigabyte).                                                                                      |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | **Default value**  | 0 (rotation by size disabled)                                                                                                                                                                                               |
|                    |                     +-----------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | Maximum number of rotated logs that will be maintained for each format.                                                                                                                                                                          |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |   rotate              | **Allowed values** | A number greater than or equal to 1, or -1 to disable log cleaning.                                                                                                                                                         |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | **Default value**  | -1 (log cleaning disabled)                                                                                                                                                                                                  |
+--------------------+---------------------+-----------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

alerts
^^^^^^

Configures the output of Wazuh alerts (``alerts.log`` and ``alerts.json`` files).

Options:

+--------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|   enabled          | Enable or disable this alerts output.                                                                                                                                                                                                                                                          |
|                    +--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    | **Allowed values** | yes, no                                                                                                                                                                                                                                                                   |
|                    +--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    | **Default value**  | no                                                                                                                                                                                                                                                                        |
+--------------------+--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|   format           | Sets the output format.                                                                                                                                                                                                                                                                        |
|                    +--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    | **Allowed values** | - plain (to write in ``alerts.log``)                                                                                                                                                                                                                                      |
|                    |                    | - json (to write in ``alerts.json``)                                                                                                                                                                                                                                      |
|                    |                    | - json,plain (to write in both files)                                                                                                                                                                                                                                     |
|                    +--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    | **Default value**  | json,plain                                                                                                                                                                                                                                                                |
+--------------------+--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|   rotation         | Configure the alerts rotation.                                                                                                                                                                                                                                                                 |
|                    +---------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    | **Allowed options** |                       | Enable or disable log rotation.                                                                                                                                                                                                                  |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |   enabled             | **Allowed values** | yes, no                                                                                                                                                                                                                     |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | **Default value**  | yes                                                                                                                                                                                                                         |
|                    |                     +-----------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | Configure the rotation interval.                                                                                                                                                                                                                 |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |   interval            | **Allowed values** | A positive number that should contain a suffix character indicating a time unit: s (seconds), m (minutes) or h (hours).                                                                                                     |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | **Default value**  | 0 (rotation by interval disabled)                                                                                                                                                                                           |
|                    |                     +-----------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | Configure the alerts compression.                                                                                                                                                                                                                |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |   compress            | **Allowed values** | yes, no                                                                                                                                                                                                                     |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | **Default value**  | yes                                                                                                                                                                                                                         |
|                    |                     +-----------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | Configure the rotation by size.                                                                                                                                                                                                                  |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |   max_size            | **Allowed values** | A positive number that should contain a suffix character indicating a time unit: B (byte), K (kilobyte), M (megabyte) or G (gigabyte).                                                                                      |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | **Default value**  | 0 (rotation by size disabled)                                                                                                                                                                                               |
|                    |                     +-----------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | Maximum number of rotated logs that will be maintained for each format.                                                                                                                                                                          |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |   rotate              | **Allowed values** | A number greater than or equal to 1, or -1 to disable log cleaning.                                                                                                                                                         |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | **Default value**  | -1 (log cleaning disabled)                                                                                                                                                                                                  |
+--------------------+---------------------+-----------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

archives
^^^^^^^^

Configures the output of Wazuh archives logs (``archives.log`` and ``archives.json`` files).

Options:

+--------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|   enabled          | Enable or disable this log output.                                                                                                                                                                                                                                                             |
|                    +--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    | **Allowed values** | yes, no                                                                                                                                                                                                                                                                   |
|                    +--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    | **Default value**  | no                                                                                                                                                                                                                                                                        |
+--------------------+--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|   format           | Sets the output format.                                                                                                                                                                                                                                                                        |
|                    +--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    | **Allowed values** | - plain (to write in ``archives.log``)                                                                                                                                                                                                                                    |
|                    |                    | - json (to write in ``archives.json``)                                                                                                                                                                                                                                    |
|                    |                    | - json,plain (to write in both files)                                                                                                                                                                                                                                     |
|                    +--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    | **Default value**  | None                                                                                                                                                                                                                                                                      |
+--------------------+--------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|   rotation         | Configure the log rotation.                                                                                                                                                                                                                                                                    |
|                    +---------------------+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    | **Allowed options** |                       | Enable or disable log rotation.                                                                                                                                                                                                                  |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |   enabled             | **Allowed values** | yes, no                                                                                                                                                                                                                     |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | **Default value**  | yes                                                                                                                                                                                                                         |
|                    |                     +-----------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | Configure the rotation interval.                                                                                                                                                                                                                 |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |   interval            | **Allowed values** | A positive number that should contain a suffix character indicating a time unit: s (seconds), m (minutes) or h (hours).                                                                                                     |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | **Default value**  | 0 (rotation by interval disabled)                                                                                                                                                                                           |
|                    |                     +-----------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | Configure the log compression.                                                                                                                                                                                                                   |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |   compress            | **Allowed values** | yes, no                                                                                                                                                                                                                     |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | **Default value**  | yes                                                                                                                                                                                                                         |
|                    |                     +-----------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | Configure the rotation by size.                                                                                                                                                                                                                  |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |   max_size            | **Allowed values** | A positive number that should contain a suffix character indicating a time unit: B (byte), K (kilobyte), M (megabyte) or G (gigabyte).                                                                                      |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | **Default value**  | 0 (rotation by size disabled)                                                                                                                                                                                               |
|                    |                     +-----------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | Maximum number of rotated logs that will be maintained for each format.                                                                                                                                                                          |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |   rotate              | **Allowed values** | A number greater than or equal to 1, or -1 to disable log cleaning.                                                                                                                                                         |
|                    |                     |                       +--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                    |                     |                       | **Default value**  | -1 (log cleaning disabled)                                                                                                                                                                                                  |
+--------------------+---------------------+-----------------------+--------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


Default configuration
---------------------

.. code-block:: xml

    <logging>
      <log>
        <enabled>yes</enabled>
        <format>json,plain</format>
        <rotation>
          <enabled>yes</enabled>
          <max_size>512M</max_size>
          <compress>yes</compress>
        </rotation>
      </log>
      <alerts>
        <enabled>yes</enabled>
        <format>json,plain</format>
        <rotation>
          <enabled>yes</enabled>
          <max_size>512M</max_size>
          <compress>yes</compress>
        </rotation>
      </alerts>
      <archives>
        <enabled>yes</enabled>
        <format>json,plain</format>
        <rotation>
          <enabled>yes</enabled>
          <max_size>512M</max_size>
          <compress>yes</compress>
        </rotation>
      </archives>
    </logging>
