.. _manual_syscheck:

How it works
==========================

Syscheck is essential for the intrusion detection.

.. image:: ../../images/manual/fim/fim.png
  :align: center
  :width: 80%

1. Wazuh agent scans the system and sends the checksums of the monitored files to the Wazuh manager. For this scan, we can configure:

  - **Frequency**: By default configured to run every 6 hours, but entirely configurable by the user.
  - **Real-time monitoring**: Wazuh supports realtime monitoring on servers running Windows or Linux. It's important to remark that the real time option is only configurable for directories, no single files.

2. Wazuh manager stores the checksums and looks for modifications by comparing the new checksums against the old checksums of that file or registry key. It's possible to configure syscheck to report the changes in the content of a text file (only for Linux hosts).

3. In case of an anomaly, an alert is generated.
  It's posible to handle false positives using some configuration options like ``ignore`` or with the creation of rules that controls those files that are excluded.

Alert example, generated by **syscheck**:
::

	** Alert 1460948255.25442: mail  - ossec,syscheck,pci_dss_11.5,
	2016 Apr 17 19:57:35 (ubuntu) 10.0.0.144->syscheck
	Rule: 550 (level 7) -> 'Integrity checksum changed.'
	Integrity checksum changed for: '/test/hello'
	Size changed from '12' to '17'
	Old md5sum was: 'e59ff97941044f85df5297e1c302d260'
	New md5sum is : '7947eba5d9cc58d440fb06912e302949'
	Old sha1sum was: '648a6a6ffffdaa0badb23b8baf90b6168dd16b3a'
	New sha1sum is : '379b74ac9b2d2b09ff6ad7fa876c79f914a755e1'


More info: :ref:`settings options <syscheck_settings>`
