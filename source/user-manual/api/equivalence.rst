.. Copyright (C) 2020 Wazuh, Inc.


.. API_changes_from_3_x_to_4_0

API changes from 3.x to 4.0
===========================

Wazuh API 4.0 introduces several new endpoints and also modifies or removes some of the old ones. The biggest change for all existing endpoints is the new response format. Endpoint responses have been changed according to the new RBAC standard and will no longer have ``items`` and ``totalitems`` fields, instead most responses will have the following structure:

.. code-block:: json
    :class: output

    {
       "data": {
          "affected_items": [],
          "total_affected_items": 0,
          "total_failed_items": 0,
          "failed_items": [],
          "message": ""
       }
    }


Equivalence table
-----------------

As Wazuh API 4.0 introduces several changes to existing endpoints it is important to review those changes if you want to migrate from 3.x API to 4.0.

The following tables contain the equivalencies between old API 3.x and API 4.0 endpoints.

Active Response
~~~~~~~~~~~~~~~

+--------------------------------+-------------------------------------+--------------------------+------------------------------------------------------------------------------------------------+
| Action                         | API 3.x                             | API 4.0                  | Changes                                                                                        |
+================================+=====================================+==========================+================================================================================================+
|                                |                                     |                          | The new Active Response endpoint runs commands in all agents by default.                       |
| Run an AR command in the agent | ``PUT /active-response/{agent_id}`` | ``PUT /active-response`` |                                                                                                |
|                                |                                     |                          | Use the ``list_agents`` parameter to apply the commands to only one agent or a list of agents. |
+--------------------------------+-------------------------------------+--------------------------+------------------------------------------------------------------------------------------------+

Agents
~~~~~~

+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Action                                           | API 3.x usage                                                 | API 4.0 usage                                                 | Changes                                                                                                                                   |
+==================================================+===============================================================+===============================================================+===========================================================================================================================================+
|                                                  |                                                               |                                                               | Removed ``ids`` query parameter.                                                                                                          |
|                                                  |                                                               |                                                               |                                                                                                                                           |
| Delete agents                                    | ``DELETE /agents``                                            | ``DELETE /agents``                                            | Use the ``list_agents`` parameter instead of ``ids`` to indicate which agents must be deleted.                                            |
|                                                  |                                                               |                                                               |                                                                                                                                           |
|                                                  |                                                               |                                                               | If no ``list_agents`` is provided all agents will be removed.                                                                             |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Delete an agent                                  | ``DELETE /agents/{agent_id}``                                 | ``DELETE /agents?list_agents=agent_id``                       | Use the ``list_agents`` parameter to indicate which agents must be deleted.                                                               |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
|                                                  |                                                               |                                                               | Added ``list_groups`` parameter in query to specify an array of group's ID to remove from the agent.                                      |
| Remove all agents groups                         | ``DELETE /agents/{agent_id}/group``                           | ``DELETE /agents/{agent_id}/group``                           |                                                                                                                                           |
|                                                  |                                                               |                                                               | Removes the agent from all groups by default or a list of them if ``list_groups`` parameter is found.                                     |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Remove a single group of an agent                | ``DELETE /agents/{agent_id}/group/{group_id}``                | ``DELETE /agents/{agent_id}/group/{group_id}``                | No major changes.                                                                                                                         |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Remove a single group of multiple agents         | ``DELETE /agents/group/{group_id}``                           | ``DELETE /agents/group?group_id=id``                          | Use the ``list_agents`` parameter to indicate from which agents the group should me removed.                                              |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
|                                                  |                                                               |                                                               | The new endpoint can delete all groups or a list of them.                                                                                 |
| Delete a list of groups                          | ``DELETE /agents/groups``                                     | ``DELETE /groups``                                            |                                                                                                                                           |
|                                                  |                                                               |                                                               | Use the ``list_groups`` to choose which ones should be deleted.                                                                           |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
|                                                  |                                                               |                                                               | The new endpoint can delete all groups or a list of them.                                                                                 |
| Remove a group                                   | ``DELETE /agents/groups/{group_id}``                          | ``DELETE /groups``                                            |                                                                                                                                           |
|                                                  |                                                               |                                                               | Use the ``list_groups`` to choose which ones should be deleted.                                                                           |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
|                                                  |                                                               |                                                               | Return information about all available agents or a list of them.                                                                          |
|                                                  |                                                               |                                                               |                                                                                                                                           |
|                                                  |                                                               |                                                               | Added parameter ``list_agents`` in query used to specify a list of agents IDs (separated by comma) from which agents get the information. |
| Get all agents                                   | ``GET /agents``                                               | ``GET /agents``                                               |                                                                                                                                           |
|                                                  |                                                               |                                                               | Added parameter ``registerIP`` in query used to filter by the IP used when registering the agent.                                         |
|                                                  |                                                               |                                                               |                                                                                                                                           |
|                                                  |                                                               |                                                               | With this new endpoint, you won't get a 400 response in agent name cannot be found,                                                       |
|                                                  |                                                               |                                                               | you will get a 200 response with 0 items in the result.                                                                                   |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Get an agent                                     | ``GET /agents/{agent_id}``                                    | ``GET /agents?list_agents=agent_id``                          | Use the ``list_agents`` parameter to indicate from which agents you want to get the information.                                          |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Get active configuration                         | ``GET /agents/{agent_id}/config/{component}/{configuration}`` | ``GET /agents/{agent_id}/config/{component}/{configuration}`` | No major changes.                                                                                                                         |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Get sync status of agent                         | ``GET /agents/{agent_id}/group/is_sync``                      | ``GET /agents/{agent_id}/group/is_sync``                      | No major changes.                                                                                                                         |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Get agent key                                    | ``GET /agents/{agent_id}/key``                                | ``GET /agents/{agent_id}/key``                                | No major changes.                                                                                                                         |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Get upgrade result from agent                    | ``GET /agents/{agent_id}/upgrade_result``                     | ``GET /agents/{agent_id}/upgrade_result``                     | No major changes.                                                                                                                         |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Get groups                                       | ``GET /agents/groups``                                        | ``GET /groups``                                               | The new endpoint works the same way by default.                                                                                           |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
|                                                  |                                                               |                                                               | Use the ``list_groups`` parameter to indicate from which group you want to get the information.                                           |
| Get agents in a group                            | ``GET /agents/groups/{group_id}``                             | ``GET /groups?list_groups=group_id``                          |                                                                                                                                           |
|                                                  |                                                               |                                                               | To get all agents in a group use ``GET /groups/{group_id}/agents``.                                                                       |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Get group configuration                          | ``GET /agents/groups/{group_id}/configuration``               | ``GET /groups/{group_id}/configuration``                      | The new endpoint works the same way by default.                                                                                           |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Get group files                                  | ``GET /agents/groups/{group_id}/files``                       | ``GET /groups/{group_id}/files``                              | The new endpoint works the same way by default.                                                                                           |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Get a file in group                              | ``GET /agents/groups/{group_id}/files/{filename}``            | ``GET /groups/{group_id}/files/{filename}/json`` or           | The new endpoint allows the user to get the specified group file parsed to JSON or XML.                                                   |
|                                                  |                                                               | ``GET /groups/{group_id}/files/{filename}/xml``               |                                                                                                                                           |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Get an agent by its name                         | ``GET /agents/name/{agent_name}``                             | ``GET /agents?name=agent_name``                               | Use the ``name`` parameter to indicate from which agent you want to get the information.                                                  |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Get agents without group                         | ``GET /agents/no_group``                                      | ``GET /agents/no_group``                                      | No major changes.                                                                                                                         |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Get outdated agents                              | ``GET /agents/outdated``                                      | ``GET /agents/outdated``                                      | Added ``search`` parameter in query used to look for elements with the specified string.                                                  |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Get distinct fields in agents                    | ``GET /agents/stats/distinct``                                | ``GET /agents/stats/distinct``                                | No major changes.                                                                                                                         |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Get agents summary                               | ``GET /agents/summary``                                       | ``GET /agents/summary/status``                                | The new Endpoint works the same way.                                                                                                      |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Get OS summary                                   | ``GET /agents/summary/os``                                    | ``GET /agents/summary/os``                                    | No major changes.                                                                                                                         |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Add agent                                        | ``POST /agents``                                              | ``POST /agents``                                              | Renamed ``force`` parameter in request body to ``force_time``.                                                                            |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Add a list of agents to a group                  | ``POST /agents/group/{group_id}``                             | ``PUT /agents/group``                                         | Use PUT instead of POST and specify the group id using the ``group_id`` parameter.                                                        |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Put configuration file (agent.conf) into a group | ``POST /agents/groups/{group_id}/configuration``              | ``PUT /groups/{group_id}/configuration``                      | The new endpoint works the same way but using PUT.                                                                                        |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Upload file into a group                         | ``POST /agents/groups/{group_id}/files/{file_name}``          | ``PUT /groups/{group_id}/configuration``                      | The new endpoint is used to update the group configuration. Use PUT instead of POST.                                                      |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Insert agent                                     | ``POST /agents/insert``                                       | ``POST /agents/insert``                                       | Renamed ``force`` parameter in request body to ``force_time``.                                                                            |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Restart a list of agents                         | ``POST /agents/restart``                                      | ``PUT /agents/restart``                                       | Works the same way but using PUT instead of POST.                                                                                         |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Add agent group                                  | ``PUT /agents/{agent_id}/group/{group_id}``                   | ``PUT /agents/{agent_id}/group/{group_id}``                   | No major changes.                                                                                                                         |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Restart an agent                                 | ``PUT /agents/{agent_id}/restart``                            | ``PUT /agents/{agent_id}/restart``                            | No major changes.                                                                                                                         |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Upgrade agent using online repository            | ``PUT /agents/{agent_id}/upgrade``                            | ``PUT /agents/{agent_id}/upgrade``                            | Changed parameter type ``force`` in request body from integer to boolean.                                                                 |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Upgrade agent using custom file                  | ``PUT /agents/{agent_id}/upgrade_custom``                     | ``PUT /agents/{agent_id}/upgrade_custom``                     | No major changes.                                                                                                                         |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Add agent (quick method)                         | ``PUT /agents/{agent_name}``                                  | ``POST /agents/insert/quick?agent_name=name``                 | Use POST instead of PUT and the ``agent_name`` parameter to specify the name of the new agent.                                            |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Create a group                                   | ``PUT /agents/groups/{group_id}``                             | ``POST /groups?group_id=group_id``                            | Use POST instead of PUT and the ``group_id`` parameter to specify the name of the new group.                                              |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
| Restart agents which belong to a group           | ``PUT /agents/groups/{group_id}/restart``                     | ``PUT /groups/{group_id}/restart``                            | The new endpoint works the same way by default.                                                                                           |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+
|                                                  |                                                               |                                                               | Added ``list_agents`` parameter in query to specify which agents must be restarted.                                                       |
| Restart all agents                               | ``PUT /agents/restart``                                       | ``PUT /agents/restart``                                       |                                                                                                                                           |
|                                                  |                                                               |                                                               | Restarts all agents by default or a list of them if ``list_agents`` parameter is used.                                                    |
+--------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+

Cache
~~~~~

+----------------------------+---------------------------+-----------------------------+---------------------------------------------------------------------------------+
| Action                     | API 3.x                   | API 4.0                     | Changes                                                                         |
+============================+===========================+=============================+=================================================================================+
| Delete cache index         | ``DELETE /cache``         | None                        | Not needed anymore. Cache is managed by the cluster.                            |
+----------------------------+---------------------------+-----------------------------+---------------------------------------------------------------------------------+
| Clear group cache          | ``DELETE /cache/{group}`` | None                        | Not needed anymore. Cache is managed by the cluster.                            |
+----------------------------+---------------------------+-----------------------------+---------------------------------------------------------------------------------+
| Get cache index            | ``GET /cache``            | None                        | Not needed anymore. Cache is managed by the cluster.                            |
+----------------------------+---------------------------+-----------------------------+---------------------------------------------------------------------------------+
| Return cache configuration | ``GET /cache/config``     | ``GET /cluster/api/config`` | The current cache configuration now can be retrieved with the cluster endpoint. |
+----------------------------+---------------------------+-----------------------------+---------------------------------------------------------------------------------+

Ciscat
~~~~~~

+-----------------------------------+------------------------------------+------------------------------------+-----------------------------------+
| Action                            | API 3.x usage                      | API 4.0 usage                      | Changes                           |
+===================================+====================================+====================================+===================================+
| Get CIS-CAT results from an agent | ``GET /ciscat/{agent_id}/results`` | ``GET /ciscat/{agent_id}/results`` | The usage is the same in API 4.0. |
+-----------------------------------+------------------------------------+------------------------------------+-----------------------------------+

Cluster
~~~~~~~

+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Action                                                    | API 3.x usage                                                 | API 4.0 usage                                                 | Changes                                                                                                                                              |
+===========================================================+===============================================================+===============================================================+======================================================================================================================================================+
| Delete a remote file in a cluster node                    | ``DELETE /cluster/{node_id}/files``                           | ``DELETE /cluster/{node_id}/files``                           | No major changes.                                                                                                                                    |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Get active configuration in node node_id                  | ``GET /cluster/{node_id}/config/{component}/{configuration}`` | ``GET /cluster/{node_id}/config/{component}/{configuration}`` | No major changes.                                                                                                                                    |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Get node node_id’s configuration                          | ``GET /cluster/{node_id}/configuration``                      | ``GET /cluster/{node_id}/configuration``                      | No major changes.                                                                                                                                    |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Check Wazuh configuration in a cluster node               | ``GET /cluster/{node_id}/configuration/validation``           | ``GET /cluster/configuration/validation?list_nodes=node_id``  | Use this endpoint to check if Wazuh configuration is correct for al cluster nodes or use ``list_nodes`` parameter to check only for a list of nodes. |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Get local file from any cluster node                      | ``GET /cluster/{node_id}/files``                              | ``GET /cluster/{node_id}/files``                              | Removed ``validation`` parameter in query. Use ``GET /cluster/configuration/validation?list_nodes=node_id`` instead if validation is needed.         |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Get node_id’s information                                 | ``GET /cluster/{node_id}/info``                               | ``GET /cluster/{node_id}/info``                               | No major changes.                                                                                                                                    |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Get ossec.log from a specific node in cluster.            | ``GET /cluster/{node_id}/logs``                               | ``GET /cluster/{node_id}/logs``                               | Removed ``q`` parameter in query.                                                                                                                    |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Get summary of ossec.log from a specific node in cluster. | ``GET /cluster/{node_id}/logs/summary``                       | ``GET /cluster/{node_id}/logs/summary``                       | No major changes.                                                                                                                                    |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Get node node_id’s stats                                  | ``GET /cluster/{node_id}/stats``                              | ``GET /cluster/{node_id}/stats``                              | Changed date format from YYYYMMDD to YYYY-MM-DD for ``date`` parameter in query.                                                                     |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Get node node_id’s analysisd stats                        | ``GET /cluster/{node_id}/stats/analysisd``                    | ``GET /cluster/{node_id}/stats/analysisd``                    | No major changes.                                                                                                                                    |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Get node node_id’s stats by hour                          | ``GET /cluster/{node_id}/stats/hourly``                       | ``GET /cluster/{node_id}/stats/hourly``                       | No major changes.                                                                                                                                    |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Get node node_id’s remoted stats                          | ``GET /cluster/{node_id}/stats/remoted``                      | ``GET /cluster/{node_id}/stats/remoted``                      | No major changes.                                                                                                                                    |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Get node node_id’s stats by week                          | ``GET /cluster/{node_id}/stats/weekly``                       | ``GET /cluster/{node_id}/stats/weekly``                       | Parameter ``hours`` changed to ``averages`` in response body.                                                                                        |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Get node node_id’s status                                 | ``GET /cluster/{node_id}/status``                             | ``GET /cluster/{node_id}/status``                             | The usage is the same in API 4.0.                                                                                                                    |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Get the cluster configuration                             | ``GET /cluster/config``                                       | ``GET /cluster/local/config``                                 | Use the ``cluster/local/config`` endpoint instead. This will get the current configuration of the node receiving the request.                        |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                           |                                                               |                                                               | Added ``list_nodes`` parameter in query.                                                                                                             |
| Check Wazuh configuration in all cluster nodes            | ``GET /cluster/configuration/validation``                     | ``GET /cluster/configuration/validation``                     |                                                                                                                                                      |
|                                                           |                                                               |                                                               | Return whether the Wazuh configuration is correct or not in all cluster nodes                                                                        |
|                                                           |                                                               |                                                               | or a list of them if parameter ``list_nodes`` is used.                                                                                               |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Show cluster health                                       | ``GET /cluster/healthcheck``                                  | ``GET /cluster/healthcheck``                                  | Renamed ``node`` parameter in query to ``list_nodes``.                                                                                               |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Get local node info                                       | ``GET /cluster/node``                                         | ``GET /cluster/nodes?list_agents=agent_id``                   | Use the ``list_agents`` parameter to indicate from which agents you want to get the information.                                                     |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                           |                                                               |                                                               | Get information about all nodes in the cluster or a list of them                                                                                     |
|                                                           |                                                               |                                                               |                                                                                                                                                      |
| Get nodes info                                            | ``GET /cluster/nodes``                                        | ``GET /cluster/nodes``                                        | Added ``list_nodes`` parameter in query used to specify from which nodes get the information.                                                        |
|                                                           |                                                               |                                                               |                                                                                                                                                      |
|                                                           |                                                               |                                                               | Removed ``q`` parameter in query.                                                                                                                    |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Get node info                                             | ``GET /cluster/nodes/{node_name}``                            | ``GET /cluster/nodes?list_nodes=node_id``                     | Use the ``list_nodes`` parameter to indicate from which nodes you want to get the information.                                                       |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Get info about cluster status                             | ``GET /cluster/status``                                       | ``GET /cluster/status``                                       | No major changes.                                                                                                                                    |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Update local file at any cluster node                     | ``POST /cluster/{node_id}/files``                             | ``PUT /cluster/{node_id}/files``                              | Use ``PUT`` instead of ``POST``.                                                                                                                     |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
| Restart a specific node in cluster                        | ``PUT /cluster/{node_id}/restart``                            | ``PUT /cluster/restart?list_nodes=node_id``                   | Use the ``list_nodes`` parameter to indicate which nodes want to restart.                                                                            |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                           |                                                               |                                                               | Added ``list_nodes`` parameter in query                                                                                                              |
| Restart all nodes in cluster                              | ``PUT /cluster/restart``                                      | ``PUT /cluster/restart``                                      |                                                                                                                                                      |
|                                                           |                                                               |                                                               | Restarts all nodes in the cluster by default or a list of them if ``list_nodes`` is found.                                                           |
+-----------------------------------------------------------+---------------------------------------------------------------+---------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+

Decoders
~~~~~~~~

+-------------------------+----------------------------------+-------------------------------------+---------------------------------------------------------------------------------------------+
| Action                  | API 3.x usage                    | API 4.0 usage                       | Changes                                                                                     |
+=========================+==================================+=====================================+=============================================================================================+
|                         |                                  |                                     | Added ``decoder_name`` parameter in query used to specify a list of decoder's names to get. |
|                         |                                  |                                     |                                                                                             |
|                         |                                  |                                     | Added ``select`` parameter in query.                                                        |
|                         |                                  |                                     |                                                                                             |
| Get all decoders        | ``GET /decoders``                | ``GET /decoders``                   | Renamed ``file`` parameter in query to ``filename``.                                        |
|                         |                                  |                                     |                                                                                             |
|                         |                                  |                                     | Renamed ``path`` parameter in query to ``relative_dirname``.                                |
+-------------------------+----------------------------------+-------------------------------------+---------------------------------------------------------------------------------------------+
| Get decoders by name    | ``GET /decoders/{decoder_name}`` | ``GET /decoders?decoder_name=name`` | Use the ``decoder_name`` parameter to indicate from which decoder get the information.      |
+-------------------------+----------------------------------+-------------------------------------+---------------------------------------------------------------------------------------------+
|                         |                                  |                                     | Removed ``download`` parameter. Use ``GET /decoders/files/{filename}/download`` instead.    |
|                         |                                  |                                     |                                                                                             |
| Get all decoders files  | ``GET /decoders/files``          | ``GET /decoders/files``             | Renamed ``file`` parameter in query to ``filename``.                                        |
|                         |                                  |                                     |                                                                                             |
|                         |                                  |                                     | Renamed ``path`` parameter in query to ``relative_dirname``.                                |
+-------------------------+----------------------------------+-------------------------------------+---------------------------------------------------------------------------------------------+
| Get all parent decoders | ``GET /decoders/parents``        | ``GET /decoders/parents``           | Added ``select`` parameter in query.                                                        |
+-------------------------+----------------------------------+-------------------------------------+---------------------------------------------------------------------------------------------+

Experimental
~~~~~~~~~~~~

+------------------------------------------+----------------------------------------------+----------------------------------------------+------------------------------------------------------------------------------------------------+
| Action                                   | API 3.x usage                                | API 4.0 usage                                | Changes                                                                                        |
+==========================================+==============================================+==============================================+================================================================================================+
| Clear syscheck database                  | ``DELETE /experimental/syscheck``            | ``DELETE /experimental/syscheck``            | Added ``list_agents`` parameter in query.                                                      |
+------------------------------------------+----------------------------------------------+----------------------------------------------+------------------------------------------------------------------------------------------------+
|                                          |                                              |                                              | Added ``list_agents`` parameter in query.                                                      |
| Get CIS-CAT results                      | ``GET /experimental/ciscat/results``         | ``GET /experimental/ciscat/results``         |                                                                                                |
|                                          |                                              |                                              | Removed ``agent_id`` parameter in query                                                        |
+------------------------------------------+----------------------------------------------+----------------------------------------------+------------------------------------------------------------------------------------------------+
|                                          |                                              |                                              | Added ``list_agents`` parameter in query.                                                      |
|                                          |                                              |                                              |                                                                                                |
|                                          |                                              |                                              | Renamed ``ram_free`` parameter in query to ``ram.free`` and changed it's type to integer.      |
|                                          |                                              |                                              |                                                                                                |
|                                          |                                              |                                              | Renamed ``ram_total`` parameter in query to ``ram.total`` and changed it's type to integer.    |
| Get hardware info of all agents          | ``GET /experimental/syscollector/hardware``  | ``GET /experimental/syscollector/hardware``  |                                                                                                |
|                                          |                                              |                                              | Renamed ``cpu_cores`` parameter in query to ``cpu.cores`` and changed it's type to integer.    |
|                                          |                                              |                                              |                                                                                                |
|                                          |                                              |                                              | Renamed ``cpu_mhz`` parameter in query to ``cpu.mhz`` and changed it's type to number.         |
|                                          |                                              |                                              |                                                                                                |
|                                          |                                              |                                              | Renamed ``cpu_name``  parameter in query to ``cpu.name``.                                      |
+------------------------------------------+----------------------------------------------+----------------------------------------------+------------------------------------------------------------------------------------------------+
| Get network address info of all agents   | ``GET /experimental/syscollector/netaddr``   | ``GET /experimental/syscollector/netaddr``   | Added ``list_agents`` parameter in query.                                                      |
+------------------------------------------+----------------------------------------------+----------------------------------------------+------------------------------------------------------------------------------------------------+
|                                          |                                              |                                              | Added ``list_agents`` parameter in query.                                                      |
|                                          |                                              |                                              |                                                                                                |
|                                          |                                              |                                              | Changed the type of ``mtu`` parameter to integer.                                              |
|                                          |                                              |                                              |                                                                                                |
|                                          |                                              |                                              | Renamed ``tx_packets`` parameter in query to ``tx.packets`` and changed it's type to integer.  |
|                                          |                                              |                                              |                                                                                                |
|                                          |                                              |                                              | Renamed ``rx_packets`` parameter in query to ``rx.packets`` and changed it's type to integer.  |
|                                          |                                              |                                              |                                                                                                |
|                                          |                                              |                                              | Renamed ``tx_bytes`` parameter in query to ``tx.bytes`` and changed it's type to integer.      |
| Get network interface info of all agents | ``GET /experimental/syscollector/netiface``  | ``GET /experimental/syscollector/netiface``  |                                                                                                |
|                                          |                                              |                                              | Renamed ``rx_bytes`` parameter in query to ``rx.bytes`` and changed it's type to integer.      |
|                                          |                                              |                                              |                                                                                                |
|                                          |                                              |                                              | Renamed ``tx_errors`` parameter in query to ``tx.errors`` and changed it's type to integer.    |
|                                          |                                              |                                              |                                                                                                |
|                                          |                                              |                                              | Renamed ``rx_errors`` parameter in query to ``rx.errors`` and changed it's type to integer.    |
|                                          |                                              |                                              |                                                                                                |
|                                          |                                              |                                              | Renamed ``tx_dropped`` parameter in query to ``tx.dropped``  and changed it's type to integer. |
|                                          |                                              |                                              |                                                                                                |
|                                          |                                              |                                              | Renamed ``rx_dropped`` parameter in query to ``rx.dropped`` and changed it's type to integer.  |
+------------------------------------------+----------------------------------------------+----------------------------------------------+------------------------------------------------------------------------------------------------+
| Get network protocol info of all agents  | ``GET /experimental/syscollector/netproto``  | ``GET /experimental/syscollector/netproto``  | Added ``list_agents`` parameter in query.                                                      |
+------------------------------------------+----------------------------------------------+----------------------------------------------+------------------------------------------------------------------------------------------------+
|                                          |                                              |                                              | Added ``list_agents`` parameter in query.                                                      |
|                                          |                                              |                                              |                                                                                                |
| Get os info of all agents                | ``GET /experimental/syscollector/os``        | ``GET /experimental/syscollector/os``        | Renamed ``os_name`` parameter in query to ``os.name``.                                         |
|                                          |                                              |                                              |                                                                                                |
|                                          |                                              |                                              | Renamed ``os_version`` parameter in query to ``os.version``.                                   |
+------------------------------------------+----------------------------------------------+----------------------------------------------+------------------------------------------------------------------------------------------------+
| Get packages info of all agents          | ``GET /experimental/syscollector/packages``  | ``GET /experimental/syscollector/packages``  | Added ``list_agents`` parameter in query.                                                      |
+------------------------------------------+----------------------------------------------+----------------------------------------------+------------------------------------------------------------------------------------------------+
|                                          |                                              |                                              | Added ``list_agents`` parameter in query.                                                      |
|                                          |                                              |                                              |                                                                                                |
|                                          |                                              |                                              | Renamed ``local_ip`` parameter to ``local.ip``.                                                |
| Get ports info of all agents             | ``GET /experimental/syscollector/ports``     | ``GET /experimental/syscollector/ports``     |                                                                                                |
|                                          |                                              |                                              | Renamed ``local_port`` parameter to ``local.port``.                                            |
|                                          |                                              |                                              |                                                                                                |
|                                          |                                              |                                              | Renamed ``remote_ip``  parameter to ``remote.ip``.                                             |
+------------------------------------------+----------------------------------------------+----------------------------------------------+------------------------------------------------------------------------------------------------+
| Get processes info of all agents         | ``GET /experimental/syscollector/processes`` | ``GET /experimental/syscollector/processes`` | Added ``list_agents`` parameter in query.                                                      |
+------------------------------------------+----------------------------------------------+----------------------------------------------+------------------------------------------------------------------------------------------------+


Lists
~~~~~

+--------------------------+----------------------+----------------------+------------------------------------------------------------------------------------------+
| Action                   | API 3.x usage        | API 4.0 usage        | Changes                                                                                  |
+==========================+======================+======================+==========================================================================================+
|                          |                      |                      | Added ``filename`` parameter in query used to filter by filename.                        |
|                          |                      |                      |                                                                                          |
|                          |                      |                      | Added ``select`` parameter in query.                                                     |
| Get all lists            | ``GET /lists``       | ``GET /lists``       |                                                                                          |
|                          |                      |                      | Renamed ``path`` parameter in query to ``relative_dirname``.                             |
+--------------------------+----------------------+----------------------+------------------------------------------------------------------------------------------+
|                          |                      |                      | Added ``filename`` parameter in query used to filter by filename.                        |
| Get paths from all lists | ``GET /lists/files`` | ``GET /lists/files`` |                                                                                          |
|                          |                      |                      | Added ``relative_dirname`` parameter in query used to filter by relative directory name. |
+--------------------------+----------------------+----------------------+------------------------------------------------------------------------------------------+


Manager
~~~~~~~

+----------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------------------------------------------------------------+
| Action                           | API 3.x usage                                       | API 4.0 usage                                       | Changes                                                                                                   |
+==================================+=====================================================+=====================================================+===========================================================================================================+
| Delete a local file              | ``DELETE /manager/files``                           | ``DELETE /manager/files``                           | No major changes.                                                                                         |
+----------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------------------------------------------------------------+
| Get manager active configuration | ``GET /manager/config/{component}/{configuration}`` | ``GET /manager/config/{component}/{configuration}`` | No major changes.                                                                                         |
+----------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------------------------------------------------------------+
| Get manager configuration        | ``GET /manager/configuration``                      | ``GET /manager/configuration``                      | No major changes.                                                                                         |
+----------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------------------------------------------------------------+
| Check Wazuh configuration        | ``GET /manager/configuration/validation``           | ``GET /manager/configuration/validation``           | No major changes.                                                                                         |
+----------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------------------------------------------------------------+
| Get local file                   | ``GET /manager/files``                              | ``GET /manager/files``                              | Removed ``validation`` parameter in query. Use `GET /manager/configuration/validation` instead if needed. |
+----------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------------------------------------------------------------+
| Get manager information          | ``GET /manager/info``                               | ``GET /manager/info``                               | Parameter `openssl_support` in response is now a boolean.                                                 |
+----------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------------------------------------------------------------+
| Get ossec.log                    | ``GET /manager/logs``                               | ``GET /manager/logs``                               | Removed ``q`` parameter in query.                                                                         |
+----------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------------------------------------------------------------+
| Get summary of ossec.log         | ``GET /manager/logs/summary``                       | ``GET /manager/logs/summary``                       | Return a summary of the last 2000 wazuh log entries instead of the last three months.                     |
+----------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------------------------------------------------------------+
| Get manager stats                | ``GET /manager/stats``                              | ``GET /manager/stats``                              | Changed date format from YYYYMMDD to YYYY-MM-DD for ``date`` parameter in query.                          |
+----------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------------------------------------------------------------+
| Get analysisd stats              | ``GET /manager/stats/analysisd``                    | ``GET /manager/stats/analysisd``                    | No major changes.                                                                                         |
+----------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------------------------------------------------------------+
| Get manager stats by hour        | ``GET /manager/stats/hourly``                       | ``GET /manager/stats/hourly``                       | No major changes.                                                                                         |
+----------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------------------------------------------------------------+
| Get remoted stats                | ``GET /manager/stats/remoted``                      | ``GET /manager/stats/remoted``                      | No major changes.                                                                                         |
+----------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------------------------------------------------------------+
| Get manager stats by week        | ``GET /manager/stats/weekly``                       | ``GET /manager/stats/weekly``                       | Parameter ``hours`` changed to ``averages`` in response body.                                             |
+----------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------------------------------------------------------------+
| Get manager status               | ``GET /manager/status``                             | ``GET /manager/status``                             | No major changes.                                                                                         |
+----------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------------------------------------------------------------+
| Update local file                | ``POST /manager/files``                             | ``PUT /manager/files``                              | The new endpoint works the same way but using ``PUT``.                                                    |
+----------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------------------------------------------------------------+
| Restart Wazuh manager            | ``PUT /manager/restart``                            | ``PUT /manager/restart``                            | No major changes.                                                                                         |
+----------------------------------+-----------------------------------------------------+-----------------------------------------------------+-----------------------------------------------------------------------------------------------------------+


MITRE
~~~~~

+-----------------------------------+------------------------------------+------------------------------------+-----------------------------------+
| Action                            | API 3.x usage                      | API 4.0 usage                      | Changes                           |
+===================================+====================================+====================================+===================================+
| Get attacks from MITRE database   | ``GET /mitre``                     | ``GET /mitre``                     | No major changes.                 |
+-----------------------------------+------------------------------------+------------------------------------+-----------------------------------+


Rootcheck
~~~~~~~~~

+--------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------------------------------------------+
| Action                               | API 3.x usage                           | API 4.0 usage                           | Changes                                                                    |
+======================================+=========================================+=========================================+============================================================================+
| Clear rootcheck database             | ``DELETE /rootcheck``                   | ``DELETE /rootcheck``                   | No major changes.                                                          |
+--------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------------------------------------------+
| Clear rootcheck database of an agent | ``DELETE /rootcheck/{agent_id}``        | ``DELETE /rootcheck/{agent_id}``        | No major changes.                                                          |
+--------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------------------------------------------+
|                                      |                                         |                                         | Added ``select`` parameter in query used to select which fields to return. |
| Get rootcheck database               | ``GET /rootcheck/{agent_id}``           | ``GET /rootcheck/{agent_id}``           |                                                                            |
|                                      |                                         |                                         | Added ``q`` parameter in query used to filter.                             |
+--------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------------------------------------------+
| Get rootcheck CIS requirements       | ``GET /rootcheck/{agent_id}/cis``       | ``GET /rootcheck/{agent_id}/cis``       | No major changes.                                                          |
+--------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------------------------------------------+
| Get last rootcheck scan              | ``GET /rootcheck/{agent_id}/last_scan`` | ``GET /rootcheck/{agent_id}/last_scan`` | No major changes.                                                          |
+--------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------------------------------------------+
| Get rootcheck pci requirements       | ``GET /rootcheck/{agent_id}/pci``       | ``GET /rootcheck/{agent_id}/pci``       | No major changes.                                                          |
+--------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------------------------------------------+
| Run rootcheck scan in all agents     | ``PUT /rootcheck``                      | ``PUT /rootcheck``                      | No major changes.                                                          |
+--------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------------------------------------------+
| Run rootcheck scan in an agent       | ``PUT /rootcheck/{agent_id}``           | ``PUT /rootcheck/{agent_id}``           | No major changes.                                                          |
+--------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------------------------------------------+


Rules
~~~~~

+-----------------------------------+----------------------------+----------------------------------------+---------------------------------------------------------------------------------------------+
| Action                            | API 3.x usage              | API 4.0 usage                          | Changes                                                                                     |
+===================================+============================+========================================+=============================================================================================+
|                                   |                            |                                        | Added ``rule_ids`` parameter in query.                                                      |
|                                   |                            |                                        |                                                                                             |
|                                   |                            |                                        | Added ``select`` parameter in query.                                                        |
|                                   |                            |                                        |                                                                                             |
| Get all rules                     | ``GET /rules``             | ``GET /rules``                         | Renamed ``file`` parameter to ``filename``.                                                 |
|                                   |                            |                                        |                                                                                             |
|                                   |                            |                                        | Renamed ``pci`` parameter in query to ``pci_dss``.                                          |
+-----------------------------------+----------------------------+----------------------------------------+---------------------------------------------------------------------------------------------+
| Get rules by id                   | ``GET /rules/{rule_id}``   | ``GET /rules?rule_ids=rule_id``        | Use the ``rules_id`` parameter to specify from which rules you want to get the information. |
+-----------------------------------+----------------------------+----------------------------------------+---------------------------------------------------------------------------------------------+
|                                   |                            |                                        | Renamed ``path`` parameter in query to ``relative_dirname``.                                |
|                                   |                            |                                        |                                                                                             |
| Get files of rules                | ``GET /rules/files``       | ``GET /rules/files``                   | Renamed ``file`` parameter in query to ``filename``.                                        |
|                                   |                            |                                        |                                                                                             |
|                                   |                            |                                        | Removed ``download`` parameter in query. Use `GET /rules/files/{file}/download` instead.    |
+-----------------------------------+----------------------------+----------------------------------------+---------------------------------------------------------------------------------------------+
| Get rule gdpr requirements        | ``GET /rules/gdpr``        | ``GET /rules/requirement/gdpr``        | Use the new `/rules/requirement` endpoint.                                                  |
+-----------------------------------+----------------------------+----------------------------------------+---------------------------------------------------------------------------------------------+
| Get rule gpg13 requirements       | ``GET /rules/gpg13``       | ``GET /rules/requirement/gpg13``       | Use the new `/rules/requirement` endpoint.                                                  |
+-----------------------------------+----------------------------+----------------------------------------+---------------------------------------------------------------------------------------------+
| Get rule groups                   | ``GET /rules/groups``      | ``GET /rules/groups``                  | No major changes.                                                                           |
+-----------------------------------+----------------------------+----------------------------------------+---------------------------------------------------------------------------------------------+
| Get rule hipaa requirements       | ``GET /rules/hipaa``       | ``GET /rules/requirement/hipaa``       | Use the new `/rules/requirement` endpoint.                                                  |
+-----------------------------------+----------------------------+----------------------------------------+---------------------------------------------------------------------------------------------+
| Get rule nist-800-53 requirements | ``GET /rules/nist-800-53`` | ``GET /rules/requirement/nist-800-53`` | Use the new `/rules/requirement` endpoint.                                                  |
+-----------------------------------+----------------------------+----------------------------------------+---------------------------------------------------------------------------------------------+
| Get rule pci requirements         | ``GET /rules/pci``         | ``GET /rules/requirement/pci_dss``     | Use the new `/rules/requirement` endpoint.                                                  |
+-----------------------------------+----------------------------+----------------------------------------+---------------------------------------------------------------------------------------------+


Security Assesment Configuration
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

+-------------------------------------------------------------+--------------------------------------------+--------------------------------------------+-------------------+
| Action                                                      | API 3.x usage                              | API 4.0 usage                              | Changes           |
+=============================================================+============================================+============================================+===================+
| Get security configuration assessment (SCA) database        | ``GET /sca/{agent_id}``                    | ``GET /sca/{agent_id}``                    | No major changes. |
+-------------------------------------------------------------+--------------------------------------------+--------------------------------------------+-------------------+
| Get security configuration assessment (SCA) checks database | ``GET /sca/{agent_id}/checks/{policy_id}`` | ``GET /sca/{agent_id}/checks/{policy_id}`` | No major changes. |
+-------------------------------------------------------------+--------------------------------------------+--------------------------------------------+-------------------+


Summary
~~~~~~~

+------------------------------+-------------------------+--------------------------+--------------------------------------------------------+
| Action                       | API 3.x usage           | API 4.0 usage            | Changes                                                |
+==============================+=========================+==========================+========================================================+
| Get a full summary of agents | ``GET /summary/agents`` | ``GET /overview/agents`` | Use the new ``GET /overview/agents`` endpoint instead. |
+------------------------------+-------------------------+--------------------------+--------------------------------------------------------+

Syscheck
~~~~~~~~

+-------------------------------------+----------------------------------------+----------------------------------------+--------------------------------------------------------------------------------------+
| Action                              | API 3.x usage                          | API 4.0 usage                          | Changes                                                                              |
+=====================================+========================================+========================================+======================================================================================+
| Clear syscheck database of an agent | ``DELETE /syscheck/{agent_id}``        | ``DELETE /syscheck/{agent_id}``        | The usage is the same in API 4.0.                                                    |
+-------------------------------------+----------------------------------------+----------------------------------------+--------------------------------------------------------------------------------------+
| Get syscheck files                  | ``GET /syscheck/{agent_id}``           | ``GET /syscheck/{agent_id}``           | The usage is the same in API 4.0.                                                    |
+-------------------------------------+----------------------------------------+----------------------------------------+--------------------------------------------------------------------------------------+
| Get last syscheck scan              | ``GET /syscheck/{agent_id}/last_scan`` | ``GET /syscheck/{agent_id}/last_scan`` | The usage is the same in API 4.0.                                                    |
+-------------------------------------+----------------------------------------+----------------------------------------+--------------------------------------------------------------------------------------+
| Run syscheck scan in all agents     | ``PUT /syscheck``                      | ``PUT /syscheck``                      | The usage is the same in API 4.0.                                                    |
+-------------------------------------+----------------------------------------+----------------------------------------+--------------------------------------------------------------------------------------+
| Run syscheck scan in an agent       | ``PUT /syscheck/{agent_id}``           | ``PUT /syscheck``                      | Use the ``list_agents`` parameter to indicate which agents must run a syscheck scan. |
+-------------------------------------+----------------------------------------+----------------------------------------+--------------------------------------------------------------------------------------+

Syscollector
~~~~~~~~~~~~

+----------------------------------------+--------------------------------------------+--------------------------------------------+------------------------------------------------------------------------------------------------+
| Action                                 | API 3.x usage                              | API 4.0 usage                              | Changes                                                                                        |
+========================================+============================================+============================================+================================================================================================+
| Get hardware info                      | ``GET /syscollector/{agent_id}/hardware``  | ``GET /syscollector/{agent_id}/hardware``  | The usage is the same in API 4.0.                                                              |
+----------------------------------------+--------------------------------------------+--------------------------------------------+------------------------------------------------------------------------------------------------+
| Get hotfixes info                      | ``GET /syscollector/{agent_id}/hotfixes``  | ``GET /syscollector/{agent_id}/hotfixes``  | Removed ``q`` parameter in query.                                                              |
+----------------------------------------+--------------------------------------------+--------------------------------------------+------------------------------------------------------------------------------------------------+
| Get network address info of an agent   | ``GET /syscollector/{agent_id}/netaddr``   | ``GET /syscollector/{agent_id}/netaddr``   | Removed ``q`` parameter in query.                                                              |
+----------------------------------------+--------------------------------------------+--------------------------------------------+------------------------------------------------------------------------------------------------+
|                                        |                                            |                                            | Removed ``q`` parameter in query.                                                              |
|                                        |                                            |                                            |                                                                                                |
|                                        |                                            |                                            | Changed the type of ``mtu`` parameter to integer.                                              |
|                                        |                                            |                                            |                                                                                                |
|                                        |                                            |                                            | Renamed ``tx_packets`` parameter in query to ``tx.packets`` and changed it's type to integer.  |
|                                        |                                            |                                            |                                                                                                |
|                                        |                                            |                                            | Renamed ``rx_packets`` parameter in query to ``rx.packets`` and changed it's type to integer.  |
|                                        |                                            |                                            |                                                                                                |
|                                        |                                            |                                            | Renamed ``tx_bytes`` parameter in query to ``tx.bytes`` and changed it's type to integer.      |
| Get network interface info of an agent | ``GET /syscollector/{agent_id}/netiface``  | ``GET /syscollector/{agent_id}/netiface``  |                                                                                                |
|                                        |                                            |                                            | Renamed ``rx_bytes`` parameter in query to ``rx.bytes`` and changed it's type to integer.      |
|                                        |                                            |                                            |                                                                                                |
|                                        |                                            |                                            | Renamed ``tx_errors`` parameter in query to ``tx.errors`` and changed it's type to integer.    |
|                                        |                                            |                                            |                                                                                                |
|                                        |                                            |                                            | Renamed ``rx_errors`` parameter in query to ``rx.errors`` and changed it's type to integer.    |
|                                        |                                            |                                            |                                                                                                |
|                                        |                                            |                                            | Renamed ``tx_dropped`` parameter in query to ``tx.dropped``  and changed it's type to integer. |
|                                        |                                            |                                            |                                                                                                |
|                                        |                                            |                                            | Renamed ``rx_dropped`` parameter in query to ``rx.dropped`` and changed it's type to integer.  |
+----------------------------------------+--------------------------------------------+--------------------------------------------+------------------------------------------------------------------------------------------------+
| Get network protocol info of an agent  | ``GET /syscollector/{agent_id}/netproto``  | ``GET /syscollector/{agent_id}/netproto``  | Removed ``q`` parameter in query.                                                              |
+----------------------------------------+--------------------------------------------+--------------------------------------------+------------------------------------------------------------------------------------------------+
| Get os info                            | ``GET /syscollector/{agent_id}/os``        | ``GET /syscollector/{agent_id}/os``        | The usage is the same in API 4.0.                                                              |
+----------------------------------------+--------------------------------------------+--------------------------------------------+------------------------------------------------------------------------------------------------+
| Get packages info                      | ``GET /syscollector/{agent_id}/packages``  | ``GET /syscollector/{agent_id}/packages``  | Removed ``q`` parameter in query.                                                              |
+----------------------------------------+--------------------------------------------+--------------------------------------------+------------------------------------------------------------------------------------------------+
|                                        |                                            |                                            | Added ``process`` parameter used to filter by process name.                                    |
|                                        |                                            |                                            |                                                                                                |
|                                        |                                            |                                            | Removed ``q`` parameter in query.                                                              |
|                                        |                                            |                                            |                                                                                                |
| Get ports info of an agent             | ``GET /syscollector/{agent_id}/ports``     | ``GET /syscollector/{agent_id}/ports``     | Renamed ``local_ip`` parameter to ``local.ip``.                                                |
|                                        |                                            |                                            |                                                                                                |
|                                        |                                            |                                            | Renamed ``local_port`` parameter to ``local.port``.                                            |
|                                        |                                            |                                            |                                                                                                |
|                                        |                                            |                                            | Renamed ``remote_ip``  parameter to ``remote.ip``.                                             |
+----------------------------------------+--------------------------------------------+--------------------------------------------+------------------------------------------------------------------------------------------------+
| Get processes info                     | ``GET /syscollector/{agent_id}/processes`` | ``GET /syscollector/{agent_id}/processes`` | Removed ``q`` parameter in query.                                                              |
+----------------------------------------+--------------------------------------------+--------------------------------------------+------------------------------------------------------------------------------------------------+
